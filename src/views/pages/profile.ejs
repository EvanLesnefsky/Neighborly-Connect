<%- include('../partials/head') %>
<%- include('../partials/menu') %>
<%- include('../partials/message')%>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<div class="container my-5" style="padding-top: 50px;">
  <div class="row">
    <div class="col-lg-8" >
      <h1 class="mb-4">My Profile: <%= username %></h1>

      <table class="table table-bordered table-striped">
        <tr>
          <td style="width: 150px;">First Name:</td>
          <td><%= first_name %></td>
        </tr>

        <tr>
          <td>Last Name:</td>
          <td><%= last_name %></td>
        </tr>

        <tr>
          <td>Email:</td>
          <td><%= email %></td>
        </tr>

        <tr>
          <td>Phone Number:</td>
          <td><%= phone_number %></td>
        </tr>

        <tr>
          <td>Gender:</td>
          <td><%= gender %></td>
        </tr>

        <tr>
          <td>Birthday:</td>
          <td><%= new Date(birthdate).toLocaleString('en-US', { month: 'long', day: 'numeric', year: 'numeric' }) %></td>
        </tr>

      </table>
    </div>


    <% if(!propertyId){ %>
      <div class="col-lg-4">
      <h1 class="mb-4">Add Your Property</h1>
      <form action="/profile" method="POST">
        <div class="form-group">
          <label for="address_1">Address 1:</label>
          <input type="text" class="form-control" name="address_1" id="address_1" required>
        </div>
        <div class="form-group">
          <label for="address_2">Address 2:</label>
          <input type="text" class="form-control" name="address_2" id="address_2">
        </div>
        <div class="form-group">
          <label for="city">City:</label>
          <input type="text" class="form-control" name="city" id="city" required>
        </div>
        <div class="form-group">
          <label for="state">State:</label>
          <input type="text" class="form-control" name="state" id="state" required>
        </div>
        <div class="form-group">
          <label for="zip">ZIP Code:</label>
          <input type="text" class="form-control" name="zip" id="zip" required>
        </div>
        <button type="submit" class="btn btn-primary btn-block" style="margin-top: 10px;">Save</button>
      </form>
    </div>
    <% }else{ %>
      <div class="col-lg-4">
        

        <h1 class="mb-4">Your Address</h1>
        <table class="table table-bordered table-striped">
          
          <% if(address_line2){ %>
            <tr>
              <td>Address Line 1:</td>
              <td><%= address_line1 %></td>
            </tr>
            <tr>
              <td>Address Line 2:</td>
              <td><%= address_line2 %></td>
            </tr>
          <% }else{ %>
            <tr>
              <td>Address Line:</td>
              <td><%= address_line1 %></td>
            </tr>
          <% } %>
          <tr>
            <td>City:</td>
            <td><%= city %></td>
          </tr>
          <tr>
            <td>State:</td>
            <td><%= state %></td>
          </tr>
          <tr>
            <td>ZIP Code:</td>
            <td><%= zipcode %></td>
          </tr>
        </table>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#updateAddressModal">
            Update Your Address
        </button>
      </div>
        
    <% } %>

  

  </div>
</div>

<div class="modal fade" id="updateAddressModal" tabindex="-1" role="dialog" aria-labelledby="updateAddressModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="updateAddressModalLabel">Update Your Address</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="/updateProfile" method="POST">
          <div class="form-group">
            <label for="address_1">Address 1:</label>
            <input type="text" class="form-control" name="address_1" id="address_1" value="<%= address_line1 %>" required>
          </div>
          <div class="form-group">
            <label for="address_2">Address 2:</label>
            <input type="text" class="form-control" name="address_2" id="address_2" value="<%= address_line2 %>">
          </div>
          <div class="form-group">
            <label for="city">City:</label>
            <input type="text" class="form-control" name="city" id="city" value="<%= city %>" required>
          </div>
          <div class="form-group">
            <label for="state">State:</label>
            <input type="text" class="form-control" name="state" id="state" value="<%= state %>" required>
          </div>
          <div class="form-group">
            <label for="zip">ZIP Code:</label>
            <input type="text" class="form-control" name="zip" id="zip" value="<%= zipcode %>" required>
          </div>
          <button type="submit" class="btn btn-primary btn-block" style="margin-top: 10px;">Update</button>
        </form>
      </div>
    </div>
  </div>
</div>

<%- include('../partials/footer') %>
<!-- <div class="d-flex align-items-center">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-9 col-sm-12 d-flex justify-content-center align-content-center">
                <img class="m-3"
                    src="https://developers.elementor.com/docs/assets/img/elementor-placeholder-image.png"
                    style="border-radius: 50%;width:10rem;height:10rem;" />
                <div class="d-flex justify-content-center flex-column mr-3">
                    <h2>
                        <%- first_name %>
                            <%= last_name %>
                    </h2>
                    <h5 class="text-secondary">@<%- username %>
                    </h5>
                    <h5 class="text-secondary">
                        <%- phone_number %> | <%- email %>
                    </h5>
                </div>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-9 col-sm-12">
                <div class="d-flex justify-content-between">
                    <h1 class="mb-4">Address</h1>
                    <button type="button" class="btn" data-bs-toggle="modal" data-bs-target="#addressModal">
                        <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor"
                            class="bi bi-plus" viewBox="0 0 16 16">
                            <path
                                d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                        </svg>
                    </button>
                </div>
                <% if(!propertyId){ %>
                    <p class="text-secondary">No Address Found</p>
                    <% }else{ %>
                        <h3 class="text-secondary">
                            <%- address_line1 %> <br>
                                <%- city %>, <%- state %>
                                        <%- zipcode %>
                        </h3>
                        <% } %>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="addressModal" tabindex="-1" role="dialog" aria-labelledby="addressModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Change Address</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                </button>
            </div>
            <div class="modal-body">
                <div id='searchBoxContainer'>
                    <input class="form-control" placeholder="Search for Address" type='text' id='searchBox' />
                </div>
                <div id="hiddenMap" style="display:none;"></div>
            </div>
            <div class="m-3" id="showAddress" style="display:none;">
                <h3 id="tempAddress" class="text-secondary"></h3>
                <button class="btn btn-primary" onclick="changeAddress(<%- propertyId %>)">Change Address</button>
            </div>
        </div>
    </div>
</div>
<script src="/public/js/script.js"></script>
<script type='text/javascript' src='https://www.bing.com/api/maps/mapcontrol?key=AljStGYPC2c0wdx-bBLB6DEKMphxfnbKeD98nf5NMJT7g_EFDUBTjzBxVN4-kqvX&callback=loadMapScenario' async defer></script>
<script>
    window.onload = loadMapScenario();
</script> -->